<!DOCTYPE html>
<html lang="en">
	<%- include('partials/header'); %>
	<body>
		<%- include('partials/nav'); %>
		<div class="container">
			<div class="row">
				<div class="col-md-3"></div>
				<div class="col-md-6">
					<form class="boxed" id="inquiry_form" method="POST" action="/contacts/store">
						<h5 class="title">Tasty Treats Inquiry Form</h5>
						<input type="text" class="phone" id="phone" name="phone">
						<div class="form-group row">
				            <label for="name" class="col-sm-2 col-form-label">Name</label>
				            <div class="col-sm-10">
				              <input type="name" class="form-control" id="name" name="name" placeholder="Your name" required />
				            </div>
				        </div>

				        <div class="form-group row">
				            <label for="email" class="col-sm-2 col-form-label">Email</label>
				            <div class="col-sm-10">
				              <input type="email" class="form-control" id="email" name="email" placeholder="Your email address" required />
				            </div>
				        </div>

				        <div class="form-group row">
				            <label for="message" class="col-sm-2 col-form-label">Message</label>
				            <div class="col-sm-10">
				              <textarea class="form-control" rows="4" id="message" name="message" placeholder="Your message" required></textarea>
				            </div>
				        </div>

				        <div class="form-group row">
			            	<div class="col-sm-2"></div>
			            	<div class="col-sm-10">
			            		<div class="form-check">
			            			<input class="form-check-input" type="checkbox" id="newsletter" name="newsletter" />
			                		<label class="form-check-label" for="newsletter">
			                  			Subscibe to newsletter
			                		</label>
			              		</div>
			              	</div>			              	
			            </div>

			            <div class="form-group row">
			            	<label for="code" class="col-sm-2 col-form-label">Captcha</label>
			            	<div class="col-sm-7">
			            		<div class="captcha-box">
								    <canvas id="canvas"></canvas>
								    <input id="code" name="code" class="form-control" autocomplete="nope">
								    <a id="refresh" href="#">Refresh</a>
								</div>			            		
			            	</div>
			            	<div class="col-sm-3">
			            		<br><br>
			            		<button type="submit" id="valid" class="btn btn-success">Submit</button>
			            	</div>
			            </div>

					</form>
				</div>
				<div class="col-md-3"></div>
			</div>
		</div>
	</body>
</html>

<script>
	var captchaLength = 4;
	const captcha = new Captcha($('#canvas'), {
		length: captchaLength
	});
	$('#refresh').on('click', function(e) {
		e.preventDefault();
		captcha.refresh();
	});
	$.validator.addMethod("checkCaptcha", function(value, element) {
    	captchaIsValid = captcha.valid($('#code').val());
    	if (captchaIsValid === false) {
			captcha.refresh();			
		}
    	return captchaIsValid;
	}, "Captcha is invalid");
	$("#inquiry_form").validate({
		rules: {
	  		name: {
	      		required: true
	    	},
	    	email: {
	    		required: true,
	    		email: true
	    	},
	    	message: {
	    		required: true,
	    		minlength: 10
	    	},
	    	code: {
	    		checkCaptcha: true
	    	}	    	
		}
	});
</script>